<header>
  <div id="brand">
    <a class="icon-link" href="{{ .Site.BaseURL }}">
      <img
        class="icon"
        src="{{ default "images/brandIcon.svg" .Site.Params.brandIconFile | relURL }}"/>
    </a>
    <div class="text">
      <a href="{{ .Site.BaseURL }}"><h1>{{ .Site.Title }}</h1></a>
      <h3>{{ default "Veni, Vidi, Coded." .Site.Params.subtitle }}</h3>
    </div>
  </div>

  <nav>
    {{ with .Site.Menus.main }}
      {{ range $index, $value := . }}
        {{ if $index }} | {{ end }}
        <a href="{{ .URL | relURL }}"><b>{{ .Name }}</b></a>
      {{ end }}
    {{ end }}
  </nav>

  <hr />

<!-- Minimal Auth UI -->
<style>
  #auth-toggle {
    position: fixed;
    top: 1rem;
    right: 1rem;
    background: #ffffffdd;
    border: 1px solid #ccc;
    padding: 6px 12px;
    border-radius: 8px;
    font-size: 14px;
    cursor: pointer;
    z-index: 1000;
  }

  #auth-modal {
    display: none;
    position: fixed;
    top: 15%;
    right: 5%;
    background: white;
    border: 1px solid #ccc;
    padding: 1.5rem;
    border-radius: 12px;
    box-shadow: 0 5px 25px rgba(0,0,0,0.2);
    z-index: 1001;
    width: 260px;
  }

  #auth-modal input {
    width: 100%;
    padding: 8px;
    margin: 0.4rem 0;
    font-size: 0.9rem;
  }

  #auth-modal button {
    width: 100%;
    padding: 8px;
    margin-top: 0.5rem;
    font-size: 0.9rem;
    background-color: #000;
    color: #fff;
    border: none;
    border-radius: 6px;
    cursor: pointer;
  }

  #auth-modal button:hover {
    background-color: #222;
  }

  .google-btn {
    background-color: #db4437 !important;
  }

  .switch-auth {
    background: none;
    border: none;
    color: #0077cc;
    font-size: 0.8rem;
    text-decoration: underline;
    cursor: pointer;
    margin-top: 0.5rem;
  }
</style>

<button id="auth-toggle">Login</button>

<div id="auth-modal">
  <input type="email" id="auth-email" placeholder="Email" />
  <input type="password" id="auth-password" placeholder="Password" />
  <button id="auth-submit">Login</button>
  <button class="google-btn" id="google-login">Login with Google</button>
  <button class="switch-auth" id="toggle-signup">Switch to Sign Up</button>
  <button id="logout-btn" style="display:none; margin-top: 1rem;">Logout</button>
</div>



</header>


<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  const supabase = supabase.createClient(
    'https://your-project-id.supabase.co',
    'your-anon-public-key'
  );

  const toggleBtn = document.getElementById('auth-toggle');
  const modal = document.getElementById('auth-modal');
  const emailInput = document.getElementById('auth-email');
  const passInput = document.getElementById('auth-password');
  const submitBtn = document.getElementById('auth-submit');
  const logoutBtn = document.getElementById('logout-btn');
  const googleBtn = document.getElementById('google-login');
  const switchAuth = document.getElementById('toggle-signup');

  let isSignup = false;

  toggleBtn.onclick = () => {
    modal.style.display = modal.style.display === 'block' ? 'none' : 'block';
  };

  switchAuth.onclick = () => {
    isSignup = !isSignup;
    submitBtn.textContent = isSignup ? 'Sign Up' : 'Login';
    switchAuth.textContent = isSignup ? 'Switch to Login' : 'Switch to Sign Up';
  };

  submitBtn.onclick = async () => {
    const email = emailInput.value;
    const password = passInput.value;

    let result;
    if (isSignup) {
      result = await supabase.auth.signUp({ email, password });
    } else {
      result = await supabase.auth.signInWithPassword({ email, password });
    }

    if (result.error) alert(result.error.message);
    else updateUI();
  };

  logoutBtn.onclick = async () => {
    await supabase.auth.signOut();
    updateUI();
  };

  googleBtn.onclick = async () => {
    const { error } = await supabase.auth.signInWithOAuth({
      provider: 'google'
    });
    if (error) alert(error.message);
  };

  async function updateUI() {
    const { data: { session } } = await supabase.auth.getSession();
    if (session?.user) {
      toggleBtn.textContent = session.user.email.split('@')[0];
      logoutBtn.style.display = 'block';
      submitBtn.style.display = googleBtn.style.display = switchAuth.style.display = 'none';
    } else {
      toggleBtn.textContent = 'Login';
      logoutBtn.style.display = 'none';
      submitBtn.style.display = googleBtn.style.display = switchAuth.style.display = 'block';
    }
    modal.style.display = 'none';
  }

  supabase.auth.onAuthStateChange(updateUI);
  updateUI();
</script>