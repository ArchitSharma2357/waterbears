<footer>
  <hr />
  {{ if .Site.Params.social }}
    <p id="social">
      Find me around the web:
      <br />
      {{ range $i, $e := .Site.Params.social }}
        {{ if $i }} | {{ end }}
        <a href="{{ .url }}">{{ .name }}</a>
      {{ end }}
    </p>
  {{ end }}

  <p class="copyright">
    Copyright © {{ now.Format "2006"}}
    <strong>{{ default "Blog Author" .Site.Params.Author }}</strong>.
  </p>

<!-- Contact Form -->
<form id="contact-form">
  <input type="text" id="name" placeholder="Your Name" required />
  <input type="email" id="email" placeholder="Your Email" required />
  <textarea id="message" placeholder="Your Message" required></textarea>
  <button type="submit">Send</button>
</form>
<p id="form-status"></p>

<!-- Supabase -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
    const supabase = window.supabase.createClient(
    'https://cmbmfdtmofhidxjugtcd.supabase.co',   
    'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNtYm1mZHRtb2ZoaWR4anVndGNkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDUyNzEwMTAsImV4cCI6MjA2MDg0NzAxMH0.y1XJNaw380hgC7Mkkl79ugvXZUfjRqMyMsnEfUXmQ8Q'                
  );

  document.getElementById('contact-form').addEventListener('submit', async (e) => {
    e.preventDefault();
    const name = document.getElementById('name').value.trim();
    const email = document.getElementById('email').value.trim();
    const message = document.getElementById('message').value.trim();
    const status = document.getElementById('form-status');

    const { error } = await supabase
      .from('contact_messages')
      .insert([{ name, email, message }]);

    if (error) {
      console.error('Insert error:', error);
      status.innerText = "❌ Failed to send. Try again.";
    } else {
      status.innerText = "✅ Message sent!";
      document.getElementById('contact-form').reset();
    }
  });
</script>


<div id="auth">
  <h2>Sign Up</h2>
  <input type="email" id="signup-email" placeholder="Email">
  <input type="password" id="signup-password" placeholder="Password">
  <button onclick="signUp()">Sign Up</button>

  <h2>Sign In</h2>
  <input type="email" id="signin-email" placeholder="Email">
  <input type="password" id="signin-password" placeholder="Password">
  <button onclick="signIn()">Sign In</button>

  <button onclick="signOut()">Sign Out</button>

  <div id="user-status"></div>
</div>  

<script>
  async function signUp() {
    const email = document.getElementById('signup-email').value;
    const password = document.getElementById('signup-password').value;
    const { user, error } = await supabase.auth.signUp({ email, password });
    if (error) {
      alert(error.message);
    } else {
      alert('Signup successful! Check your email to confirm.');
    }
  }

  async function signIn() {
    const email = document.getElementById('signin-email').value;
    const password = document.getElementById('signin-password').value;
    const { data, error } = await supabase.auth.signInWithPassword({ email, password });
    if (error) {
      alert(error.message);
    } else {
      alert('Login successful!');
      updateUser();
    }
  }

  async function signOut() {
    await supabase.auth.signOut();
    alert('Signed out!');
    updateUser();
  }

  async function updateUser() {
    const { data: { user } } = await supabase.auth.getUser();
    const status = document.getElementById('user-status');
    if (user) {
      status.innerText = `Logged in as: ${user.email}`;
    } else {
      status.innerText = 'Not logged in.';
    }
  }

  updateUser(); // Call on load
</script>  